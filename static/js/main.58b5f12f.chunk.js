(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{28:function(e,t,a){e.exports=a(50)},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){"use strict";a.r(t);var n=a(16),s=a.n(n),r=a(13),o=a(18),c=a(1),l=a(2),i=a(4),m=a(3),u=a(5),h=a(0),p=a.n(h),d=a(24),g=a.n(d),f=a(8),b=a(14),E=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=!0===this.props.signedIn?p.a.createElement(f.c,{to:"/logout"},p.a.createElement("li",{className:"nav-btn"},"Log Out")):p.a.createElement(f.c,{to:"/login"},p.a.createElement("li",{className:"nav-btn"},"Login")),t=!0===this.props.signedIn?p.a.createElement("ul",null,p.a.createElement(f.c,{exact:!0,to:"/"},p.a.createElement("li",{className:"nav-btn"},"Home")),p.a.createElement(f.c,{to:"/register"},p.a.createElement("li",{className:"nav-btn"},"Register")),e):null;return p.a.createElement("header",{id:"navbar"},p.a.createElement(f.b,{to:"/"},p.a.createElement("h1",{className:"title"},"Blog")),t)}}]),t}(p.a.Component);var v=function(){return p.a.createElement("footer",null,"Example Blog, designed by Allden @ Github")},y=a(11),j=a(12),N=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).onChangeHandler=function(e){var t=e.target,n=Object(j.a)({},a.state);n[t.name]=t.value,a.setState(Object(j.a)({},n))},a.onSubmitHandler=function(e){e.preventDefault(),a.props.createPostHandler(a.state.title,a.state.content),a.setState({title:"",content:""})},a.state={title:"",content:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return p.a.createElement("div",{id:"post-form"},p.a.createElement("form",{onSubmit:this.onSubmitHandler},p.a.createElement("label",{htmlFor:"title"},"Title"),p.a.createElement("input",{value:this.state.title,onChange:this.onChangeHandler,type:"text",id:"title",name:"title",placeholder:"What is your post title?"}),p.a.createElement("label",{htmlFor:"content"},"Content"),p.a.createElement("textarea",{value:this.state.content,onChange:this.onChangeHandler,id:"content-input",name:"content",placeholder:"What would you like to share?"}),p.a.createElement("button",{className:"btn"},"Post")))}}]),t}(p.a.Component);function O(e){return p.a.createElement("div",{id:"content"},p.a.createElement(S,{signedIn:e.signedIn,posts:e.posts,togglePublish:e.togglePublish,createPostHandler:e.createPostHandler,deleteHandler:e.deleteHandler,message:e.message,page:e.page,changePage:e.changePage}),p.a.createElement(C,{signedIn:e.signedIn}))}function C(e){var t=!0===e.signedIn?p.a.createElement("p",{className:"r-b-l p-1"},"Welcome to the blog! You are currently an administrator."):p.a.createElement("p",{className:"r-b-l p-1"},"This is the visitor view of the page. ",p.a.createElement("br",null)," To login, visit this page: ",p.a.createElement(f.b,{to:"/login"},"Login"),p.a.createElement("br",null),"Username: admin@example.com",p.a.createElement("br",null),"Password: admin!");return p.a.createElement("section",{id:"about"},p.a.createElement("div",{className:"content-title dark-bg"},p.a.createElement("h4",null,"About the blog:")),t)}function S(e){var t=e.posts.filter((function(t){return!!e.signedIn||!0===t.published})),a=Object(r.a)(t).splice(3*e.page,3),n=a.length>0?a.map((function(t){return p.a.createElement("div",{key:t._id,className:"post"},p.a.createElement("div",{className:"content-title"},p.a.createElement("h3",{className:"centered-text"},t.title)),p.a.createElement("div",{className:"post-content r-l limiter"},p.a.createElement("div",{className:"post-info"},p.a.createElement("p",{className:"primary-color"},"By ",t.author)),p.a.createElement("p",null,t.content)),!0===e.signedIn?p.a.createElement("div",{className:"actions"},p.a.createElement("div",{className:"ud-bar"},t.published?p.a.createElement("button",{onClick:function(){return e.togglePublish(t._id,t.published)},className:"ud-ops dark-bg"},"Unpublish"):p.a.createElement("button",{onClick:function(){return e.togglePublish(t._id,t.published)},className:"ud-ops dark-bg"},"Publish"),p.a.createElement("button",{className:"ud-ops dark-bg",onClick:function(){return e.deleteHandler(t._id)}},"Delete")),p.a.createElement(f.b,{to:"/posts/"+t._id},p.a.createElement("button",{className:"btn view"},"View"))):p.a.createElement("div",{className:"actions"},p.a.createElement(f.b,{to:"/posts/"+t._id},p.a.createElement("button",{className:"btn view"},"View"))))})):p.a.createElement("div",{className:"post"},p.a.createElement("div",{className:"content-title"},p.a.createElement("h3",{className:"centered-text"},"Nothing here but crickets....")),p.a.createElement("div",{className:"post-content centered-text r-b-l limiter"},p.a.createElement("p",null,"Perhaps there'll be posts eventually!"))),s=!0===e.signedIn?p.a.createElement(N,{createPostHandler:e.createPostHandler}):null,o=Array(Math.ceil(t.length/3)).fill(null).map((function(t,a){return e.page===a?p.a.createElement("li",{className:"current",onClick:function(){return e.changePage(a)},key:a},a):p.a.createElement("li",{onClick:function(){return e.changePage(a)},key:a},a)})),c=Object(r.a)(o).slice(e.page,e.page+2),l=Object(r.a)(o).slice(e.page-1,e.page+2);return p.a.createElement("div",{className:"posts"},s,n,p.a.createElement("ul",{className:"pagination"},e.page>1&&o.length>5?o[0]:null,o.length>5?0===e.page?c:l:o,e.page<t.length-2&&o.length>5?o[t.length-1]:null))}var k=function(e){return p.a.createElement("div",{className:"alert"},p.a.createElement("p",{className:"centered-text"},e.message))};var w=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).onChangeHandler=function(e){var t=e.target,n=t.value,s=t.id;a.setState(Object(y.a)({},s,n))},a.state={search:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return p.a.createElement("div",{className:"search-bar"},p.a.createElement("input",{value:this.state.search,onChange:this.onChangeHandler,type:"text",id:"search",name:"search",placeholder:"Enter a title"}),p.a.createElement("button",{className:"btn",onClick:function(){return e.props.searchHandler(e.state.search)}},"Search"))}}]),t}(p.a.Component),H=function(e){return p.a.createElement("div",{id:"container"},e.message?p.a.createElement(k,{message:e.message}):null,p.a.createElement(w,{searchHandler:e.searchHandler}),p.a.createElement(O,{changePage:e.changePage,signedIn:e.signedIn,posts:e.posts,message:e.message,togglePublish:e.togglePublish,createPostHandler:e.createPostHandler,deleteHandler:e.deleteHandler,page:e.page}))},P=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={username:"",password:"",statusMessage:""},a.onChangeHandler=function(e){var t=e.target,n=Object(j.a)({},a.state);n[t.name]=t.value,a.setState(Object(j.a)({},n))},a.loginPost=function(){var e=Object(o.a)(s.a.mark((function e(t){var n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.state.username,password:a.state.password})},e.next=4,fetch("https://top-blog-backend.herokuapp.com/login",n).then((function(e){return e.json()})).then((function(e){e.token?(localStorage.setItem("jwt","Bearer "+e.token),a.props.toggleLoginState(),a.setState({statusMessage:e.message+" Redirecting you..."}),a.timer=setTimeout((function(){a.props.history.push("/")}),2e3)):(a.setState({statusMessage:e.message}),clearInterval(a.statusTimer),a.statusTimer=setTimeout((function(){a.setState({statusMessage:""})}),2e3))})).catch((function(e){return console.log(e)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.timer),clearInterval(this.statusTimer)}},{key:"render",value:function(){var e=this.state.statusMessage?p.a.createElement(k,{message:this.state.statusMessage}):null;return p.a.createElement("div",{id:"post-form",className:"center-container"},p.a.createElement("div",{className:"form-container"},p.a.createElement("h2",{className:"primary-color centered-text"},"Please Sign In"),e,p.a.createElement("form",{className:"medium-box",onSubmit:this.loginPost},p.a.createElement("label",{htmlFor:"username"},"Username (Email)"),p.a.createElement("input",{value:this.state.username,onChange:this.onChangeHandler,type:"email",id:"username",name:"username",placeholder:"What is your username?"}),p.a.createElement("label",{htmlFor:"password"},"Password"),p.a.createElement("input",{value:this.state.password,onChange:this.onChangeHandler,type:"password",id:"password",name:"password",placeholder:"What is your password?"}),p.a.createElement("button",{className:"btn"},"Login"))))}}]),t}(p.a.Component),I=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.timer=setTimeout((function(){localStorage.setItem("jwt",""),e.props.toggleLoginState(),e.props.history.push("/")}),2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){return p.a.createElement("div",{className:"center-container"},p.a.createElement("h2",{className:"large-text centered-text"},"You have been logged out."),p.a.createElement("p",{className:"centered-text"},"Redirecting..."))}}]),t}(p.a.Component),x=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={firstName:"",lastName:"",email:"",password:"",password2:"",statusMessage:""},a.onChangeHandler=function(e){var t=e.target;a.setState(Object(y.a)({},t.id,t.value))},a.onSubmitHandler=function(e){e.preventDefault();var t=a.state,n=t.firstName,s=t.lastName,r=t.email,o=t.password,c=t.password2,l=localStorage.getItem("jwt"),i={method:"POST",headers:{Authorization:l,"Content-Type":"application/json"},body:JSON.stringify({firstName:n,lastName:s,email:r,password:o,password2:c})};l?fetch("https://top-blog-backend.herokuapp.com/register",i).then((function(e){return e.json()})).then((function(e){a.setState({statusMessage:e.message}),clearInterval(a.statusTimer),a.statusTimer=setTimeout((function(){a.setState({statusMessage:""})}),2e3)})).catch((function(e){return console.log(e)})):(a.setState({statusMessage:"You need to be logged in to perform this action."}),clearInterval(a.statusTimer),a.statusTimer=setTimeout((function(){a.setState({statusMessage:""})}),2e3))},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentWillUnmount",value:function(){clearInterval(this.statusTimer)}},{key:"render",value:function(){var e=this.state.statusMessage?p.a.createElement(k,{message:this.state.statusMessage}):"";return p.a.createElement("div",{id:"post-form",onSubmit:this.onSubmitHandler,className:"center-container"},p.a.createElement("div",{className:"form-container"},p.a.createElement("h2",{className:"primary-color centered-text"},"Register Another User"),e,p.a.createElement("form",{className:"medium-box"},p.a.createElement("label",{htmlFor:"firstName"},"First Name: "),p.a.createElement("input",{value:this.state.firstName,onChange:this.onChangeHandler,type:"text",id:"firstName",placeholder:"What is your first name?"}),p.a.createElement("label",{htmlFor:"lastName"},"Last Name: "),p.a.createElement("input",{value:this.state.lastName,onChange:this.onChangeHandler,type:"text",id:"lastName",placeholder:"What is your last name?"}),p.a.createElement("label",{htmlFor:"email"},"Email: "),p.a.createElement("input",{value:this.state.email,onChange:this.onChangeHandler,type:"email",id:"email",placeholder:"What is your email?"}),p.a.createElement("label",{htmlFor:"password"},"Password: "),p.a.createElement("input",{value:this.state.password,onChange:this.onChangeHandler,type:"password",id:"password",placeholder:"What is your password?"}),p.a.createElement("label",{htmlFor:"password2"},"Confirm Password: "),p.a.createElement("input",{value:this.state.password2,onChange:this.onChangeHandler,type:"password",id:"password2",placeholder:"Please confirm your password."}),p.a.createElement("button",{className:"btn"},"Register"))))}}]),t}(p.a.Component),T=a(27),M=a.n(T),L=(a(40),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),o=0;o<n;o++)s[o]=arguments[o];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={comments:[],message:""},a.fetchPost=function(){fetch("https://top-blog-backend.herokuapp.com/posts/"+a.props.match.params.id+"/comments").then((function(e){return e.json()})).then((function(e){a.setState({comments:Object(r.a)(e.comments)})})).catch((function(e){return console.log(e)}))},a.postComment=function(e,t){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,content:t,timeOfCreation:new Date})};fetch("https://top-blog-backend.herokuapp.com/posts/"+a.props.match.params.id+"/comments",n).then((function(e){return e.json()})).then((function(e){e.message&&(clearInterval(a.timer),a.setState({message:e.message}),a.timer=setTimeout((function(){a.setState({message:""})}),2e3),e.comment&&a.fetchPost())})).catch((function(e){return console.log(e)}))},a.componentWillUnmount=function(){clearInterval(a.timer)},a.deleteComment=function(e){var t=localStorage.getItem("jwt"),n={method:"DELETE",headers:{Authorization:t}};t?(console.log("https://top-blog-backend.herokuapp.com/posts/".concat(a.props.match.params.id,"/comments/").concat(e)),fetch("https://top-blog-backend.herokuapp.com/posts/".concat(a.props.match.params.id,"/comments/").concat(e),n).then((function(e){return e.json()})).then((function(e){a.setState({message:e.message}),a.fetchPost()})).catch((function(e){return console.log(e)}))):(clearInterval(a.timer),a.setState({message:"You need to be signed in to do this."}),a.timer=setTimeout((function(){a.setState({message:""})}),2e3))},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchPost()}},{key:"render",value:function(){var e=this,t=this.state.message?p.a.createElement(k,{message:this.state.message}):null,a=this.state.comments.length>0?this.state.comments.map((function(t){return p.a.createElement(W,{signedIn:e.props.signedIn,key:t._id,id:t._id,deleteComment:e.deleteComment,time:t.timeOfCreation,name:t.postedBy,content:t.content})})):p.a.createElement("p",{className:"centered-text"},"There are no comments yet.");return p.a.createElement("div",{id:"comments"},p.a.createElement("h2",{className:"primary-color"},"Comments"),t,p.a.createElement(D,{postComment:this.postComment}),a)}}]),t}(p.a.Component));function W(e){var t=!0===e.signedIn?p.a.createElement("div",null,p.a.createElement("div",{className:"comment-content p-1 r-l"},p.a.createElement("p",null,e.content)),p.a.createElement("button",{onClick:function(){return e.deleteComment(e.id)},className:"btn delete"},"Delete")):p.a.createElement("div",{className:"comment-content p-1 r-b-l m-b-1"},p.a.createElement("p",null,e.content));return p.a.createElement("div",{className:"comment"},p.a.createElement("div",{className:"content-title h-align-space-btwn p-1-vertical-half"},p.a.createElement("p",null,"By ",e.name),p.a.createElement("p",{className:"time"},M()(e.time).format("lll"))),t)}var D=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,s=new Array(n),r=0;r<n;r++)s[r]=arguments[r];return(a=Object(i.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(s)))).state={content:"",name:""},a.onChangeHandler=function(e){var t=e.target;a.setState(Object(y.a)({},t.id,t.value))},a.onSubmitHandler=function(e){var t=a.state,n=t.name,s=t.content;e.preventDefault(),a.props.postComment(n,s),a.setState({content:"",name:""})},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return p.a.createElement("form",{onSubmit:this.onSubmitHandler,className:"comment-section"},p.a.createElement("label",{htmlFor:"name"},"Name: "),p.a.createElement("input",{onChange:this.onChangeHandler,value:this.state.name,type:"text",id:"name",placeholder:"What do you want people to refer to you as?"}),p.a.createElement("label",{htmlFor:"content"},"Content: "),p.a.createElement("textarea",{onChange:this.onChangeHandler,value:this.state.content,id:"content",placeholder:"What do you want to comment?"}),p.a.createElement("button",{className:"btn"},"Comment"))}}]),t}(p.a.Component),A=L,F=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).state={post:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;fetch("https://top-blog-backend.herokuapp.com/posts/"+this.props.match.params.id).then((function(e){return e.json()})).then((function(t){e.setState({post:Object(j.a)({},t.post)})}))}},{key:"render",value:function(){return p.a.createElement("div",{id:"container"},p.a.createElement("div",{id:"content"},p.a.createElement("div",{className:"posts"},p.a.createElement("div",{key:this.state.post._id,className:"post margin-toggle"},p.a.createElement("div",{className:"content-title"},p.a.createElement("h3",{className:"centered-text"},this.state.post.title)),p.a.createElement("div",{className:"post-content r-b-l"},p.a.createElement("div",{className:"post-info"},p.a.createElement("p",{className:"primary-color"},"By ",this.state.post.author)),p.a.createElement("p",null,this.state.post.content))),p.a.createElement(A,this.props)),p.a.createElement(C,null)))}}]),t}(p.a.Component);var U=function(){return p.a.createElement("div",{className:"center-container"},p.a.createElement("h2",{className:"large-text primary-color"},"Error 404"),p.a.createElement("p",{className:"medium-text"},"Route not found!"))},_=(a(41),a(42),a(43),a(44),a(45),a(46),a(47),a(48),a(49),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(m.a)(t).call(this,e))).toggleLoginState=function(){""!==localStorage.getItem("jwt")?a.setState({signedIn:!0,page:0}):a.setState({signedIn:!1,page:0})},a.deleteHandler=function(e){var t=localStorage.getItem("jwt");t?fetch("https://top-blog-backend.herokuapp.com/posts/"+e,{method:"DELETE",headers:{Authorization:t}}).then((function(e){return e.json()})).then((function(e){a.successHandler(e)})).catch((function(e){return console.log(e)})):a.errorHandler()},a.togglePublish=function(e,t){var n=localStorage.getItem("jwt"),s={method:"PUT",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({published:"".concat(!t)})};n?fetch("https://top-blog-backend.herokuapp.com/posts/"+e,s).then((function(e){return e.json()})).then((function(e){a.successHandler(e)})).catch((function(e){return console.log(e)})):a.errorHandler()},a.errorHandler=function(){clearInterval(a.timer),a.setState({message:"You need to be signed in to perform this action."}),a.timer=setInterval((function(){a.setState({message:""})}),2e3)},a.successHandler=function(e){clearInterval(a.timer),a.fetchPosts(e.message),a.timer=setInterval((function(){a.setState({message:""})}),2e3)},a.createNewPost=function(e,t){var n=localStorage.getItem("jwt"),s={method:"POST",headers:{"Content-Type":"application/json",Authorization:n},body:JSON.stringify({title:e,content:t,timeOfCreation:new Date})};n?fetch("https://top-blog-backend.herokuapp.com/posts",s).then((function(e){return e.json()})).then((function(e){a.successHandler(e)})).catch((function(e){return console.log(e)})):a.errorHandler()},a.changePage=function(e){a.setState({page:e})},a.searchHandler=function(e){a.setState({search:e,page:0},a.fetchPosts)},a.state={posts:[],page:0,search:"",signedIn:!1,message:""},a}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.fetchPosts(),this.toggleLoginState()}},{key:"fetchPosts",value:function(){var e=Object(o.a)(s.a.mark((function e(){var t,a,n=this,o=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:"",a=this.state.search,e.next=4,fetch("https://top-blog-backend.herokuapp.com/posts/?search=".concat(a)).then((function(e){return e.json()})).then((function(e){n.setState({posts:Object(r.a)(e.posts),message:t},console.log(n.state.posts))})).catch((function(e){return console.log(e)}));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return p.a.createElement("div",{id:"parent"},p.a.createElement(f.a,null,p.a.createElement(E,{signedIn:this.state.signedIn}),p.a.createElement(b.d,null,p.a.createElement(b.b,{exact:!0,path:"/",render:function(){return p.a.createElement(H,{changePage:e.changePage,page:e.state.page,signedIn:e.state.signedIn,posts:e.state.posts,message:e.state.message,createPostHandler:e.createNewPost,togglePublish:e.togglePublish,deleteHandler:e.deleteHandler,searchHandler:e.searchHandler})}}),p.a.createElement(b.b,{exact:!0,path:"/register",render:function(t){return e.state.signedIn?p.a.createElement(x,t):p.a.createElement(b.a,{to:"/"})}}),p.a.createElement(b.b,{exact:!0,path:"/login",render:function(t){return p.a.createElement(P,Object.assign({toggleLoginState:e.toggleLoginState},t))}}),p.a.createElement(b.b,{exact:!0,path:"/logout",render:function(t){return e.state.signedIn?p.a.createElement(I,Object.assign({toggleLoginState:e.toggleLoginState},t)):p.a.createElement(b.a,{to:"/"})}}),p.a.createElement(b.b,{exact:!0,path:"/posts/:id",render:function(t){return p.a.createElement(F,Object.assign({},t,{signedIn:e.state.signedIn}))}}),p.a.createElement(b.b,{component:U})),p.a.createElement(v,null)))}}]),t}(p.a.Component));g.a.render(p.a.createElement(_,null),document.getElementById("root"))}},[[28,1,2]]]);
//# sourceMappingURL=main.58b5f12f.chunk.js.map