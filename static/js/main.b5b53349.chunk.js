(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{27:function(e,t,a){e.exports=a(49)},39:function(e,t,a){},40:function(e,t,a){},41:function(e,t,a){},42:function(e,t,a){},43:function(e,t,a){},44:function(e,t,a){},45:function(e,t,a){},46:function(e,t,a){},47:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){"use strict";a.r(t);var n=a(1),s=a(2),r=a(4),o=a(3),c=a(0),l=a.n(c),i=a(22),m=a.n(i),u=a(6),h=a(12),p=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=!0===this.props.signedIn?l.a.createElement(u.c,{to:"/logout"},l.a.createElement("li",{className:"nav-btn"},"Log Out")):l.a.createElement(u.c,{to:"/login"},l.a.createElement("li",{className:"nav-btn"},"Login")),t=!0===this.props.signedIn?l.a.createElement("ul",null,l.a.createElement(u.c,{exact:!0,to:"/"},l.a.createElement("li",{className:"nav-btn"},"Home")),l.a.createElement(u.c,{to:"/register"},l.a.createElement("li",{className:"nav-btn"},"Register")),e):null;return l.a.createElement("header",{id:"navbar"},l.a.createElement(u.b,{to:"/"},l.a.createElement("h1",{className:"title"},"Blog")),t)}}]),a}(l.a.Component);var d=function(){return l.a.createElement("footer",null,"Example Blog, designed by Allden @ Github")},g=a(10),f=a(14),b=a(11),E=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).onChangeHandler=function(e){var t=e.target,a=Object(b.a)({},s.state);a[t.name]=t.value,s.setState(Object(b.a)({},a))},s.onSubmitHandler=function(e){e.preventDefault(),s.props.createPostHandler(s.state.title,s.state.content),s.setState({title:"",content:""})},s.state={title:"",content:""},s}return Object(s.a)(a,[{key:"render",value:function(){return l.a.createElement("div",{id:"post-form"},l.a.createElement("form",{onSubmit:this.onSubmitHandler},l.a.createElement("label",{htmlFor:"title"},"Title"),l.a.createElement("input",{value:this.state.title,onChange:this.onChangeHandler,type:"text",id:"title",name:"title",placeholder:"What is your post title?"}),l.a.createElement("label",{htmlFor:"content"},"Content"),l.a.createElement("textarea",{value:this.state.content,onChange:this.onChangeHandler,id:"content-input",name:"content",placeholder:"What would you like to share?"}),l.a.createElement("button",{className:"btn"},"Post")))}}]),a}(l.a.Component);var v=function(e){var t=!0===e.signedIn?l.a.createElement("p",null,"Welcome to the blog! You are currently an administrator."):l.a.createElement("p",null,"This is the visitor view of the page. ",l.a.createElement("br",null)," To login, visit this page: ",l.a.createElement(u.b,{to:"/login"},"Login"));return l.a.createElement("section",{className:"about primary-bg"},t)};function y(e){return l.a.createElement("div",{id:"content"},l.a.createElement(v,{signedIn:e.signedIn,message:e.message}),l.a.createElement(N,{signedIn:e.signedIn,posts:e.posts,togglePublish:e.togglePublish,createPostHandler:e.createPostHandler,deleteHandler:e.deleteHandler,message:e.message,page:e.page,changePage:e.changePage}))}function N(e){var t=e.posts.filter((function(t){return!!e.signedIn||!0===t.published})),a=Object(f.a)(t).splice(3*e.page,3),n=a.length>0?a.map((function(t){return l.a.createElement("div",{key:t._id,className:"post"},l.a.createElement("div",{className:"content-title"},l.a.createElement("h3",{className:"centered-text"},t.title)),l.a.createElement("div",{className:"post-content r-l limiter"},l.a.createElement("div",{className:"post-info"},l.a.createElement("p",{className:"complement-color"},"By ",t.author)),l.a.createElement("p",null,t.content)),!0===e.signedIn?l.a.createElement("div",{className:"actions"},l.a.createElement("div",{className:"ud-bar"},t.published?l.a.createElement("button",{onClick:function(){return e.togglePublish(t._id,t.published)},className:"ud-ops complement-bg"},"Unpublish"):l.a.createElement("button",{onClick:function(){return e.togglePublish(t._id,t.published)},className:"ud-ops complement-bg"},"Publish"),l.a.createElement("button",{className:"ud-ops complement-bg",onClick:function(){return e.deleteHandler(t._id)}},"Delete")),l.a.createElement(u.b,{to:"/posts/"+t._id},l.a.createElement("button",{className:"btn view"},"View"))):l.a.createElement("div",{className:"actions"},l.a.createElement(u.b,{to:"/posts/"+t._id},l.a.createElement("button",{className:"btn view"},"View"))))})):l.a.createElement("div",{className:"post"},l.a.createElement("div",{className:"content-title"},l.a.createElement("h3",{className:"centered-text"},"Nothing here but crickets....")),l.a.createElement("div",{className:"post-content centered-text r-b-l limiter"},l.a.createElement("p",null,"Perhaps there'll be posts eventually!"))),s=!0===e.signedIn?l.a.createElement(E,{createPostHandler:e.createPostHandler}):null,r=Array(Math.ceil(t.length/3)).fill(null).map((function(t,a){return e.page===a?l.a.createElement("li",{className:"current",onClick:function(){return e.changePage(a)},key:a},a):l.a.createElement("li",{onClick:function(){return e.changePage(a)},key:a},a)})),o=Object(f.a)(r).slice(e.page,e.page+2),c=Object(f.a)(r).slice(e.page-1,e.page+2);return l.a.createElement("div",{className:"posts"},s,n,l.a.createElement("ul",{className:"pagination"},e.page>1&&r.length>5?r[0]:null,r.length>5?0===e.page?o:c:r,e.page<t.length-2&&r.length>5?r[t.length-1]:null))}var j=function(e){return l.a.createElement("div",{className:"alert"},l.a.createElement("p",{className:"centered-text"},e.message))};var O=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).onChangeHandler=function(e){var t=e.target,a=t.value,n=t.id;s.setState(Object(g.a)({},n,a))},s.state={search:""},s}return Object(s.a)(a,[{key:"render",value:function(){var e=this;return l.a.createElement("div",{className:"search-bar"},l.a.createElement("input",{value:this.state.search,onChange:this.onChangeHandler,type:"text",id:"search",name:"search",placeholder:"Enter a title"}),l.a.createElement("button",{className:"btn",onClick:function(){return e.props.searchHandler(e.state.search)}},"Search"))}}]),a}(l.a.Component),S=function(e){return l.a.createElement("div",{id:"container"},e.message?l.a.createElement(j,{message:e.message}):null,l.a.createElement(O,{searchHandler:e.searchHandler}),l.a.createElement(y,{changePage:e.changePage,signedIn:e.signedIn,posts:e.posts,message:e.message,togglePublish:e.togglePublish,createPostHandler:e.createPostHandler,deleteHandler:e.deleteHandler,page:e.page}))},C=a(19),k=a.n(C),w=a(25),H=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={username:"admin@example.com",password:"admin!",statusMessage:""},e.onChangeHandler=function(t){var a=t.target,n=Object(b.a)({},e.state);n[a.name]=a.value,e.setState(Object(b.a)({},n))},e.loginPost=function(){var t=Object(w.a)(k.a.mark((function t(a){var n;return k.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a.preventDefault(),n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.state.username,password:e.state.password})},t.next=4,fetch("https://top-blog-backend.herokuapp.com/login",n).then((function(e){return e.json()})).then((function(t){t.token?(localStorage.setItem("jwt","Bearer "+t.token),e.props.toggleLoginState(),e.setState({statusMessage:t.message+" Redirecting you..."}),e.timer=setTimeout((function(){e.props.history.push("/")}),2e3)):(e.setState({statusMessage:t.message}),clearInterval(e.statusTimer),e.statusTimer=setTimeout((function(){e.setState({statusMessage:""})}),2e3))})).catch((function(e){return console.log(e)}));case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(s.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.timer),clearInterval(this.statusTimer)}},{key:"render",value:function(){var e=this.state.statusMessage?l.a.createElement(j,{message:this.state.statusMessage}):null;return l.a.createElement("div",{id:"post-form",className:"center-container"},l.a.createElement("div",{className:"form-container"},l.a.createElement("h2",{className:"primary-color centered-text"},"Please Sign In"),e,l.a.createElement("form",{className:"medium-box",onSubmit:this.loginPost},l.a.createElement("label",{htmlFor:"username"},"Username (Email)"),l.a.createElement("input",{value:this.state.username,onChange:this.onChangeHandler,type:"email",id:"username",name:"username",placeholder:"What is your username?"}),l.a.createElement("label",{htmlFor:"password"},"Password"),l.a.createElement("input",{value:this.state.password,onChange:this.onChangeHandler,type:"password",id:"password",name:"password",placeholder:"What is your password?"}),l.a.createElement("button",{className:"btn"},"Login"))))}}]),a}(l.a.Component),I=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){return Object(n.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.timer=setTimeout((function(){localStorage.setItem("jwt",""),e.props.toggleLoginState(),e.props.history.push("/")}),2e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.timer)}},{key:"render",value:function(){return l.a.createElement("div",{className:"center-container primary-color"},l.a.createElement("h2",{className:"large-text centered-text"},"You have been logged out."),l.a.createElement("p",{className:"centered-text"},"Redirecting..."))}}]),a}(l.a.Component),P=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={firstName:"",lastName:"",email:"",password:"",password2:"",statusMessage:""},e.onChangeHandler=function(t){var a=t.target;e.setState(Object(g.a)({},a.id,a.value))},e.onSubmitHandler=function(t){t.preventDefault();var a=e.state,n=a.firstName,s=a.lastName,r=a.email,o=a.password,c=a.password2,l=localStorage.getItem("jwt"),i={method:"POST",headers:{Authorization:l,"Content-Type":"application/json"},body:JSON.stringify({firstName:n,lastName:s,email:r,password:o,password2:c})};l?fetch("https://top-blog-backend.herokuapp.com/register",i).then((function(e){return e.json()})).then((function(t){e.setState({statusMessage:t.message}),clearInterval(e.statusTimer),e.statusTimer=setTimeout((function(){e.setState({statusMessage:""})}),2e3)})).catch((function(e){return console.log(e)})):(e.setState({statusMessage:"You need to be logged in to perform this action."}),clearInterval(e.statusTimer),e.statusTimer=setTimeout((function(){e.setState({statusMessage:""})}),2e3))},e}return Object(s.a)(a,[{key:"componentWillUnmount",value:function(){clearInterval(this.statusTimer)}},{key:"render",value:function(){var e=this.state.statusMessage?l.a.createElement(j,{message:this.state.statusMessage}):"";return l.a.createElement("div",{id:"post-form",onSubmit:this.onSubmitHandler,className:"center-container"},l.a.createElement("div",{className:"form-container"},l.a.createElement("h2",{className:"primary-color centered-text"},"Register Another User"),e,l.a.createElement("form",{className:"medium-box"},l.a.createElement("label",{htmlFor:"firstName"},"First Name: "),l.a.createElement("input",{value:this.state.firstName,onChange:this.onChangeHandler,type:"text",id:"firstName",placeholder:"What is your first name?"}),l.a.createElement("label",{htmlFor:"lastName"},"Last Name: "),l.a.createElement("input",{value:this.state.lastName,onChange:this.onChangeHandler,type:"text",id:"lastName",placeholder:"What is your last name?"}),l.a.createElement("label",{htmlFor:"email"},"Email: "),l.a.createElement("input",{value:this.state.email,onChange:this.onChangeHandler,type:"email",id:"email",placeholder:"What is your email?"}),l.a.createElement("label",{htmlFor:"password"},"Password: "),l.a.createElement("input",{value:this.state.password,onChange:this.onChangeHandler,type:"password",id:"password",placeholder:"What is your password?"}),l.a.createElement("label",{htmlFor:"password2"},"Confirm Password: "),l.a.createElement("input",{value:this.state.password2,onChange:this.onChangeHandler,type:"password",id:"password2",placeholder:"Please confirm your password."}),l.a.createElement("button",{className:"btn"},"Register"))))}}]),a}(l.a.Component),x=a(26),T=a.n(x),M=(a(39),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={comments:[],message:""},e.fetchPost=function(){fetch("https://top-blog-backend.herokuapp.com/posts/"+e.props.match.params.id+"/comments").then((function(e){return e.json()})).then((function(t){e.setState({comments:Object(f.a)(t.comments)})})).catch((function(e){return console.log(e)}))},e.postComment=function(t,a){var n={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,content:a})};fetch("https://top-blog-backend.herokuapp.com/posts/"+e.props.match.params.id+"/comments",n).then((function(e){return e.json()})).then((function(t){t.message&&(clearInterval(e.timer),e.setState({message:t.message}),e.timer=setTimeout((function(){e.setState({message:""})}),2e3),t.comment&&e.fetchPost())})).catch((function(e){return console.log(e)}))},e.componentWillUnmount=function(){clearInterval(e.timer)},e.deleteComment=function(t){var a=localStorage.getItem("jwt"),n={method:"DELETE",headers:{Authorization:a}};a?fetch("https://top-blog-backend.herokuapp.com/posts/".concat(e.props.match.params.id,"/comments/").concat(t),n).then((function(e){return e.json()})).then((function(t){e.setState({message:t.message}),e.fetchPost()})).catch((function(e){return console.log(e)})):(clearInterval(e.timer),e.setState({message:"You need to be signed in to do this."}),e.timer=setTimeout((function(){e.setState({message:""})}),2e3))},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.fetchPost()}},{key:"render",value:function(){var e=this,t=this.state.message?l.a.createElement(j,{message:this.state.message}):null,a=this.state.comments.length>0?this.state.comments.map((function(t){return l.a.createElement(L,{signedIn:e.props.signedIn,key:t._id,id:t._id,deleteComment:e.deleteComment,time:t.timeOfCreation,name:t.postedBy,content:t.content})})):l.a.createElement("div",{className:"primary-bg light-color p-1"},l.a.createElement("p",{className:"centered-text"},"There are no comments yet."));return l.a.createElement("div",{id:"comments"},l.a.createElement("h2",{className:"primary-color centered-text"},"Comments"),t,l.a.createElement(W,{postComment:this.postComment}),a)}}]),a}(l.a.Component));function L(e){var t=!0===e.signedIn?l.a.createElement("div",null,l.a.createElement("div",{className:"comment-content p-1 r-l"},l.a.createElement("p",null,e.content)),l.a.createElement("button",{onClick:function(){return e.deleteComment(e.id)},className:"btn delete m-0"},"Delete")):l.a.createElement("div",{className:"comment-content p-1 r-b-l m-b-1"},l.a.createElement("p",null,e.content));return l.a.createElement("div",{className:"comment"},l.a.createElement("div",{className:"content-title h-align-space-btwn p-1-vertical-half"},l.a.createElement("p",null,"By ",e.name),l.a.createElement("p",{className:"time"},T()(e.time).format("lll"))),t)}var W=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(){var e;Object(n.a)(this,a);for(var s=arguments.length,r=new Array(s),o=0;o<s;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={content:"",name:""},e.onChangeHandler=function(t){var a=t.target;e.setState(Object(g.a)({},a.id,a.value))},e.onSubmitHandler=function(t){var a=e.state,n=a.name,s=a.content;t.preventDefault(),e.props.postComment(n,s),e.setState({content:"",name:""})},e}return Object(s.a)(a,[{key:"render",value:function(){return l.a.createElement("form",{onSubmit:this.onSubmitHandler,className:"comment-section"},l.a.createElement("label",{htmlFor:"name"},"Name: "),l.a.createElement("input",{onChange:this.onChangeHandler,value:this.state.name,type:"text",id:"name",placeholder:"What do you want people to refer to you as?"}),l.a.createElement("label",{htmlFor:"content"},"Content: "),l.a.createElement("textarea",{onChange:this.onChangeHandler,value:this.state.content,id:"content",placeholder:"What do you want to comment?"}),l.a.createElement("button",{className:"btn"},"Comment"))}}]),a}(l.a.Component),F=M,A=function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).state={post:""},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){var e=this;fetch("https://top-blog-backend.herokuapp.com/posts/"+this.props.match.params.id).then((function(e){return e.json()})).then((function(t){e.setState({post:Object(b.a)({},t.post)})}))}},{key:"render",value:function(){return l.a.createElement("div",{id:"container"},l.a.createElement("div",{id:"content"},l.a.createElement(v,{signedIn:this.props.signedIn}),l.a.createElement("div",{className:"posts"},l.a.createElement("div",{key:this.state.post._id,className:"post margin-toggle"},l.a.createElement("div",{className:"content-title"},l.a.createElement("h3",{className:"centered-text"},this.state.post.title)),l.a.createElement("div",{className:"post-content r-b-l"},l.a.createElement("div",{className:"post-info"},l.a.createElement("p",{className:"complement-color"},"By ",this.state.post.author)),l.a.createElement("p",null,this.state.post.content))),l.a.createElement(F,this.props))))}}]),a}(l.a.Component);var D=function(){return l.a.createElement("div",{className:"center-container primary-bg"},l.a.createElement("h2",{className:"large-text complement-color"},"Error 404"),l.a.createElement("p",{className:"medium-text"},"Route not found!"))},B=(a(40),a(41),a(42),a(43),a(44),a(45),a(46),a(47),a(48),function(e){Object(r.a)(a,e);var t=Object(o.a)(a);function a(e){var s;return Object(n.a)(this,a),(s=t.call(this,e)).toggleLoginState=function(){var e=localStorage.getItem("jwt");e&&""!==e?s.setState({signedIn:!0,page:0}):s.setState({signedIn:!1,page:0})},s.deleteHandler=function(e){var t=localStorage.getItem("jwt");t?fetch("https://top-blog-backend.herokuapp.com/posts/"+e,{method:"DELETE",headers:{Authorization:t}}).then((function(e){return e.json()})).then((function(e){s.successHandler(e)})).catch((function(e){return console.log(e)})):s.errorHandler()},s.togglePublish=function(e,t){var a=localStorage.getItem("jwt"),n={method:"PUT",headers:{"Content-Type":"application/json",Authorization:a},body:JSON.stringify({published:"".concat(!t)})};a?fetch("https://top-blog-backend.herokuapp.com/posts/"+e,n).then((function(e){return e.json()})).then((function(e){s.successHandler(e)})).catch((function(e){return console.log(e)})):s.errorHandler()},s.errorHandler=function(){clearInterval(s.timer),s.setState({message:"You need to be signed in to perform this action."}),s.timer=setInterval((function(){s.setState({message:""})}),2e3)},s.successHandler=function(e){clearInterval(s.timer),s.fetchPosts(e.message),s.timer=setInterval((function(){s.setState({message:""})}),2e3)},s.createNewPost=function(e,t){var a=localStorage.getItem("jwt"),n={method:"POST",headers:{"Content-Type":"application/json",Authorization:a},body:JSON.stringify({title:e,content:t})};a?fetch("https://top-blog-backend.herokuapp.com/posts",n).then((function(e){return e.json()})).then((function(e){s.successHandler(e)})).catch((function(e){return console.log(e)})):s.errorHandler()},s.changePage=function(e){s.setState({page:e})},s.searchHandler=function(e){s.setState({search:e,page:0},s.fetchPosts)},s.state={posts:[],page:0,search:"",signedIn:!1,message:""},s}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.fetchPosts(),this.toggleLoginState()}},{key:"fetchPosts",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=this.state.search;fetch("https://top-blog-backend.herokuapp.com/posts/?search=".concat(a)).then((function(e){return e.json()})).then((function(a){e.setState({posts:a.posts,message:t})})).catch((function(e){return console.log(e)}))}},{key:"render",value:function(){var e=this;return l.a.createElement("div",{id:"parent"},l.a.createElement(u.a,null,l.a.createElement(p,{signedIn:this.state.signedIn}),l.a.createElement(h.d,null,l.a.createElement(h.b,{exact:!0,path:"/",render:function(){return l.a.createElement(S,{changePage:e.changePage,page:e.state.page,signedIn:e.state.signedIn,posts:e.state.posts,message:e.state.message,createPostHandler:e.createNewPost,togglePublish:e.togglePublish,deleteHandler:e.deleteHandler,searchHandler:e.searchHandler})}}),l.a.createElement(h.b,{exact:!0,path:"/react-blog",render:function(){return l.a.createElement(h.a,{to:"/"})}}),l.a.createElement(h.b,{exact:!0,path:"/React-Blog-Frontend-Unbuilt",render:function(){return l.a.createElement(h.a,{to:"/"})}}),l.a.createElement(h.b,{exact:!0,path:"/register",render:function(t){return e.state.signedIn?l.a.createElement(P,t):l.a.createElement(h.a,{to:"/"})}}),l.a.createElement(h.b,{exact:!0,path:"/login",render:function(t){return l.a.createElement(H,Object.assign({toggleLoginState:e.toggleLoginState},t))}}),l.a.createElement(h.b,{exact:!0,path:"/logout",render:function(t){return e.state.signedIn?l.a.createElement(I,Object.assign({toggleLoginState:e.toggleLoginState},t)):l.a.createElement(h.a,{to:"/"})}}),l.a.createElement(h.b,{exact:!0,path:"/posts/:id",render:function(t){return l.a.createElement(A,Object.assign({},t,{signedIn:e.state.signedIn}))}}),l.a.createElement(h.b,{component:D})),l.a.createElement(d,null)))}}]),a}(l.a.Component));m.a.render(l.a.createElement(B,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.b5b53349.chunk.js.map